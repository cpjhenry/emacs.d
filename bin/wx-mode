#!/bin/bash
# Weather back-end for Emacs
# 2024-01-13

function wx() {
	local wURL="https://weather.gc.ca/rss/city/on-118_e.xml" # Ottawa
	curl -s $wURL |xml2 |grep "title=Current Conditions" |sed 's/^.*: //;$s/[^.]$/&./'
	curl -s $wURL |xml2 |grep -m1 -A3 'term=Weather Forecasts' |
		sed -n '/summary=/s/^.*summary=//p' |
		sed 's/ Forecast issued.*$//' |fold -s$(tput cols); }

wx
